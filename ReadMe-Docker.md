# About this LabCAS docker

This branch for the LabCAS docker system is created to use reverse proxy server, create proper containers connections, logging and data separation. LabCAs System contains following main components
   LabCAS GUI
   LabCAS backend
   LabCAS authentication (LDAP and OktaSAML based)

In this branch we are creating a docker system which creates a docker network so these components can communicate properly.

## Table of Contents

- [Overview](#overview)
- [Developers Notes](#developers)
- [Instructions](#instructions)


## Overview

This project is created to automate deployment of various LabCAS system components.
This LabCAS docker runs individual components in containers and they can communicate with each other over internal docker network, this is achieved by docker-compose file.
Idea is to create customizable containers which can run on any development platforms (lcoal, test, prod, dev).
A reverse proxy is set up using nginx server. So the all the SSL related settings are done at one level and all the containers need not be exposed to outside the network.


##  Developers Notes

This section is for developers to help further update the current system as per requirements.
1. 'docker-compose.yml'
This file contains the information and configurations for the Docker containers.
2. Volumes  
In the docker-compose file the "Volumes" section is used to update the host folder/directory mapped to containers. This helps to persist the data and track all logs without loosing them upon recreation of images and containers.
3. Log Files
Logs here are meant to address, system, service and application logs for all the different components. These log files help address any system issues.
Update the logs files and directories for each container. 
For example nginx proxy server called 'labcas-proxy' has a standard /var/log/nginx to collect all the logs generated by nginx. And in the docker-compose volumes its mapped to ./data/logs  on the host machine. Similar things can be done for other applications.
4. commom/ubuntubase
A a common ubuntubase is added to be used by various containers. Currently used by auth and labcas-ui containers. 
5. .env files
Each container can have local.dev, prod.dev, test.env which can contain container specific environment variables. These can be set directly in these files or can be access by remote env service or some other ways but those are appropriately set per container and per compose files.
6. nginx-default.conf 
This is part of labcas-proxy container which takes care of all the routing and ssl related settings for all the services. In this file set containers and application  with their paths.

## Instructions

Following are three comments used to build, run and bring down the applications (System components/ docker containers). Go into the directory where docker-compose file located and then use  following commands

1. Build applications
    'docker-compose build'

2. Run applications
    'docker-compose up -d'

3. Bring Down
    'docker-compose down'

4. Check status
    'docker-compose ps'